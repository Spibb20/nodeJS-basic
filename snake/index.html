<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Snaky Snaky</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        background-color: darkgray;
      }
      .board {
        margin: 50px auto;
        background: radial-gradient(circle at center, #4caf50, #2e7d32 100%);
        position: relative;
        border-radius: 12px;
        border: 4px solid #1b5e20;
        overflow: hidden;
      }
      .prey {
        background-color: tomato;
        border-radius: 50%;
        position: absolute;
      }
      .snake-tail {
        background: radial-gradient(circle at 30% 30%, #66bb6a, #2e7d32);
        position: absolute;
        border-radius: 50%;
        box-shadow: inset -2px -2px 4px rgba(0, 0, 0, 0.3),
          inset 2px 2px 4px rgba(255, 255, 255, 0.2);
      }
    </style>
  </head>
  <body>
    <div style="text-align: center" id="speed"></div>
    <div class="board" id="board">
      <div id="tails"></div>
      <div class="prey" id="preyid"></div>
    </div>

    <div style="text-align: center" id="score"></div>

    <script>
      const unit = 20;
      const board = {
        height: 15,
        width: 15,
      };
      let head = { x: 4, y: 5 };

      let tails = [
        { x: 2, y: 5 },
        { x: 3, y: 5 },
        { x: 4, y: 5 },
      ];
      let direction = "right";
      let prey = {
        x: 0,
        y: 0,
      };
      let score;
      let speed = 7;
      let counter = 0;
      const preyElement = document.getElementById("preyid");
      const boardElement = document.getElementById("board");
      const tailsElement = document.getElementById("tails");

      function init() {
        const boardWidth = board.width * unit;
        boardElement.style.width = `${boardWidth}px`;

        const boardHeight = board.height * unit;
        boardElement.style.height = `${boardHeight}px`;
        generateNewPrey();

        preyElement.style.height = `${unit}px`;
        preyElement.style.width = `${unit}px`;
        preyElement.style.left = `${prey.x * unit}px`;
        preyElement.style.top = `${prey.y * unit}px`;
      }
      init();

      function changeDircetion(newDirection) {
        if (direction === "up" || direction === "down") {
          if (newDirection === "right" || newDirection === "left") {
            direction = newDirection;
          }
        } else {
          if (newDirection === "up" || newDirection === "down") {
            direction = newDirection;
          }
        }
      }

      function goRight() {
        head.x = head.x + 1;
        if (head.x === board.width) {
          head.x = 0;
        }
      }
      function goLeft() {
        head.x = head.x - 1;
        if (head.x === -1) {
          head.x = board.width;
        }
      }

      function goDown() {
        head.y = head.y + 1;
        if (head.y === board.height) {
          head.y = 0;
        }
      }
      function goUp() {
        head.y = head.y - 1;
        if (head.y === -1) {
          head.y = board.height;
        }
      }

      function render() {
        const tailsHtml = tails
          .map(
            (tail) => `<div style=" width: ${unit}px;
        height: ${unit}px;
        left: ${tail.x * unit}px;
        top: ${tail.y * unit}px"
        class="snake-tail"></div>
        `
          )
          .join("");

        tailsElement.innerHTML = tailsHtml;
      }
      function generateNewPrey() {
        prey = {
          x: Math.floor(Math.random() * board.width),
          y: Math.floor(Math.random() * board.height),
        };

        preyElement.style.left = `${prey.x * unit}px`;
        preyElement.style.top = `${prey.y * unit}px`;
      }

      function reset() {
        head = { x: 4, y: 5 };

        tails = [
          { x: 2, y: 5 },
          { x: 3, y: 5 },
          { x: 4, y: 5 },
        ];
        direction = "right";
        prey = {
          x: 0,
          y: 0,
        };
        generateNewPrey();
      }

      setInterval(() => {
        if (direction === "right") {
          goRight();
        } else if (direction === "left") {
          goLeft();
        } else if (direction === "up") {
          goUp();
        } else if (direction === "down") {
          goDown();
        }

        tails.push({ x: head.x, y: head.y });
        tails.shift();

        for (let i = 0; i < tails.length - 1; i++) {
          if (head.x === tails[i].x && head.y === tails[i].y) {
            alert("Game Over!!");
            reset();
          }
        }

        if (head.x === prey.x && head.y === prey.y) {
          counter++;
          if (counter === 5) {
            speed++;
            document.getElementById("speed").innerText = `Speed: ${speed}`;
          }
          score = score + 10 * speed;
          document.getElementById(
            "score"
          ).innerText = `Your score is : ${score}`;
          tails.push({ x: head.x, y: head.y });
          generateNewPrey();
        }

        render();
      }, 600 - speed * 50);

      addEventListener("keydown", (event) => {
        if (event.key === "ArrowDown") {
          changeDircetion("down");
        } else if (event.key === "ArrowUp") {
          changeDircetion("up");
        } else if (event.key === "ArrowLeft") {
          changeDircetion("left");
        } else if (event.key === "ArrowRight") {
          changeDircetion("right");
        }
      });
    </script>
  </body>
</html>
